name: C++ Build & Test (Linux)

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout del repository
        uses: actions/checkout@v4

      - name: Installare Eigen
        run: |
          sudo apt update
          sudo apt install -y libeigen3-dev
          echo "âœ… Eigen installato"

      - name: Controllare la posizione di Eigen
        run: |
          echo "ğŸ“‚ Contenuto di /usr/include/eigen3:"
          ls -l /usr/include/eigen3
          echo "ğŸ“‚ Contenuto di /usr/include:"
          ls -l /usr/include | grep eigen

      - name: Creare la cartella build
        run: mkdir -p build

      - name: Compilare il codice
        run: |
          g++ -Wall -O3 -std=c++17 -fopenmp -I/usr/include/eigen3 main.cpp -o build/main.exe
        continue-on-error: true

      - name: Stampare eventuali errori di compilazione
        if: failure()
        run: echo "âŒ Errore di compilazione: verifica gli include di Eigen"
        
      - name: Verificare la presenza dell'eseguibile
        run: ls -l build/

      - name: Testare l'eseguibile
        run: ./build/main.exe 0.001 0 0 1000
