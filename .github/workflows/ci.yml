name: C++ Build & Test (Linux)

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout del repository
        uses: actions/checkout@v4

      - name: Installare Eigen
        run: sudo apt update && sudo apt install -y libeigen3-dev

      - name: Creare la cartella build
        run: mkdir -p build

      - name: Compilare il codice
        run: |
          g++ -Wall -O3 -std=c++17 -fopenmp -I/usr/include/eigen3 main.cpp -o build/main
          echo "✅ Compilazione completata"

      - name: Verificare se il file è stato generato
        run: ls -l build/

      - name: Testare l'eseguibile
        run: |
          ./build/main 0.01 0 0 100 || { echo "❌ Errore durante l'esecuzione"; exit 1; }
